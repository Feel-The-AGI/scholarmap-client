(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87151,(e,t,r)=>{t.exports=e.r(47181)},99023,e=>{"use strict";e.i(87778);var t=e.i(19415),r=e.i(51576),s=e.i(32139),n=e.i(73407),o=e.i(92833),a=e.i(43030),i=e.i(51529),l=r,c=e.i(63272);function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class d extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,i.isHTMLElement)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function h({children:e,isPresent:s,anchorX:n,root:o}){let a=(0,l.useId)(),i=(0,l.useRef)(null),h=(0,l.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=(0,l.useContext)(c.MotionConfigContext),m=function(...e){return r.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=u(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():u(e[t],null)}}}}(...e),e)}(i,e.props?.ref??e?.ref);return(0,l.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:l,right:c}=h.current;if(s||!i.current||!e||!t)return;let u="left"===n?`left: ${l}`:`right: ${c}`;i.current.dataset.motionPopId=a;let d=document.createElement("style");p&&(d.nonce=p);let m=o??document.head;return m.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            top: ${r}px !important;
          }
        `),()=>{m.contains(d)&&m.removeChild(d)}},[s]),(0,t.jsx)(d,{isPresent:s,childRef:i,sizeRef:h,children:l.cloneElement(e,{ref:m})})}let p=({children:e,initial:s,isPresent:o,onExitComplete:i,custom:l,presenceAffectsLayout:c,mode:u,anchorX:d,root:p})=>{let f=(0,n.useConstant)(m),g=(0,r.useId)(),x=!0,w=(0,r.useMemo)(()=>(x=!1,{id:g,initial:s,isPresent:o,custom:l,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;i&&i()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[o,f,i]);return c&&x&&(w={...w}),(0,r.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[o]),r.useEffect(()=>{o||f.size||!i||i()},[o]),"popLayout"===u&&(e=(0,t.jsx)(h,{isPresent:o,anchorX:d,root:p,children:e})),(0,t.jsx)(a.PresenceContext.Provider,{value:w,children:e})};function m(){return new Map}var f=e.i(89120);let g=e=>e.key||"";function x(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let w=({children:e,custom:a,initial:i=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:u="sync",propagate:d=!1,anchorX:h="left",root:m})=>{let[w,y]=(0,f.usePresence)(d),_=(0,r.useMemo)(()=>x(e),[e]),b=d&&!w?[]:_.map(g),C=(0,r.useRef)(!0),v=(0,r.useRef)(_),L=(0,n.useConstant)(()=>new Map),j=(0,r.useRef)(new Set),[k,N]=(0,r.useState)(_),[S,P]=(0,r.useState)(_);(0,o.useIsomorphicLayoutEffect)(()=>{C.current=!1,v.current=_;for(let e=0;e<S.length;e++){let t=g(S[e]);b.includes(t)?(L.delete(t),j.current.delete(t)):!0!==L.get(t)&&L.set(t,!1)}},[S,b.length,b.join("-")]);let R=[];if(_!==k){let e=[..._];for(let t=0;t<S.length;t++){let r=S[t],s=g(r);b.includes(s)||(e.splice(t,0,r),R.push(r))}return"wait"===u&&R.length&&(e=R),P(x(e)),N(_),null}let{forceRender:E}=(0,r.useContext)(s.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:S.map(e=>{let r=g(e),s=(!d||!!w)&&(_===S||b.includes(r));return(0,t.jsx)(p,{isPresent:s,initial:(!C.current||!!i)&&void 0,custom:a,presenceAffectsLayout:c,mode:u,root:m,onExitComplete:s?void 0:()=>{if(j.current.has(r)||(j.current.add(r),!L.has(r)))return;L.set(r,!0);let e=!0;L.forEach(t=>{t||(e=!1)}),e&&(E?.(),P(v.current),d&&y?.(),l&&l())},anchorX:h,children:e},r)})})};e.s(["AnimatePresence",()=>w],99023)},66606,e=>{"use strict";var t=e.i(87778),r=e.i(19415),s=e.i(51576),n=e.i(87151),o=e.i(78408),a=e.i(99023),i=e.i(94690),l=e.i(7471);let c=`Hey there! I'm Ada, your scholarship advisor. Let's chat for a couple of minutes so I can find the perfect scholarships for you.

What's your name and where are you from?`;function u(){let{user:e,refreshUser:u}=(0,i.useAuth)(),d=(0,n.useRouter)(),h=(0,l.createClient)(),[p,m]=(0,s.useState)([{role:"assistant",content:c,timestamp:new Date().toISOString()}]),[f,g]=(0,s.useState)(""),[x,w]=(0,s.useState)(!1),[y,_]=(0,s.useState)({}),[b,C]=(0,s.useState)(0),[v,L]=(0,s.useState)(!1),[j,k]=(0,s.useState)(!1),N=(0,s.useRef)(null),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{("SpeechRecognition"in window||"webkitSpeechRecognition"in window)&&k(!0)},[]),(0,s.useEffect)(()=>{N.current?.scrollIntoView({behavior:"smooth"})},[p]);let P=async()=>{if(!f.trim()||x)return;let e={role:"user",content:f.trim(),timestamp:new Date().toISOString()};m(t=>[...t,e]),g(""),w(!0);try{let r=await fetch(`${t.default.env.NEXT_PUBLIC_AGENT_URL}/onboarding/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...p,e],current_step:b,extracted_data:y})});if(!r.ok)throw Error("Failed to get response");let s=await r.json();s.extracted_data&&_(e=>({...e,...s.extracted_data}));let n={role:"assistant",content:s.response,timestamp:new Date().toISOString()};m(e=>[...e,n]),C(s.next_step),s.is_complete&&await E(s.extracted_data)}catch(t){console.error("Chat error:",t),R(e.content)}finally{w(!1)}},R=e=>{let t="",r={...y};switch(b){case 0:let s=e.split(/from|,/i);s.length>=1&&(r.full_name=s[0].replace(/i'm|i am|my name is/i,"").trim()),s.length>=2&&(r.nationality=s[1].trim()),t=`Nice to meet you${r.full_name?`, ${r.full_name}`:""}! What are you currently studying or what did you last complete? (e.g., "Finished BSc in Computer Science at MIT")`,C(1);break;case 1:e.toLowerCase().includes("bachelor")||e.toLowerCase().includes("bsc")||e.toLowerCase().includes("ba")?r.current_education_level="undergraduate":e.toLowerCase().includes("master")||e.toLowerCase().includes("msc")||e.toLowerCase().includes("ma")?r.current_education_level="graduate":e.toLowerCase().includes("phd")||e.toLowerCase().includes("doctor")?r.current_education_level="professional":(e.toLowerCase().includes("high school")||e.toLowerCase().includes("secondary"))&&(r.current_education_level="high_school"),t="Got it! So you're looking for a Master's, PhD, or another degree next? And which countries are you interested in studying in?",C(2);break;case 2:e.toLowerCase().includes("master")?r.target_degree="masters":e.toLowerCase().includes("phd")||e.toLowerCase().includes("doctor")?r.target_degree="phd":e.toLowerCase().includes("bachelor")?r.target_degree="bachelor":e.toLowerCase().includes("postdoc")&&(r.target_degree="postdoc");let n=[];(e.toLowerCase().includes("us")||e.toLowerCase().includes("america")||e.toLowerCase().includes("usa"))&&n.push("United States"),(e.toLowerCase().includes("uk")||e.toLowerCase().includes("britain")||e.toLowerCase().includes("england"))&&n.push("United Kingdom"),e.toLowerCase().includes("canada")&&n.push("Canada"),e.toLowerCase().includes("germany")&&n.push("Germany"),e.toLowerCase().includes("australia")&&n.push("Australia"),r.preferred_countries=n,t="Great choices! Quick question - what was your GPA (roughly)? And do you have any work experience?",C(3);break;case 3:let o=e.match(/(\d+\.?\d*)/);o&&(r.gpa=parseFloat(o[1]));let a=e.match(/(\d+)\s*(year|month)/i);a&&(r.work_experience_years="month"===a[2].toLowerCase()?Math.round(parseInt(a[1])/12):parseInt(a[1])),t="Last thing - any special circumstances that might help your application? (First-generation student, financial need, disability, refugee status?)",C(4);break;case 4:r.circumstances={financial_need:e.toLowerCase().includes("financial")||e.toLowerCase().includes("aid")||e.toLowerCase().includes("need"),first_gen:e.toLowerCase().includes("first")||e.toLowerCase().includes("first-gen")||e.toLowerCase().includes("first generation"),refugee:e.toLowerCase().includes("refugee")||e.toLowerCase().includes("displaced"),disability:e.toLowerCase().includes("disability")||e.toLowerCase().includes("disabled")},t="Perfect! I've got everything I need. Let me find the best scholarships for you...",C(5),setTimeout(()=>E(r),1500);break;default:t="Thanks! Processing your information..."}_(r),m(e=>[...e,{role:"assistant",content:t,timestamp:new Date().toISOString()}])},E=async t=>{if(e)try{t.full_name?await h.from("users").update({full_name:t.full_name,onboarding_complete:!0}).eq("id",e.id):await h.from("users").update({onboarding_complete:!0}).eq("id",e.id),await h.from("academic_profiles").update({nationality:t.nationality,country_of_residence:t.country_of_residence,current_education_level:t.current_education_level,current_institution:t.current_institution,graduation_year:t.graduation_year,gpa:t.gpa,target_degree:t.target_degree,target_fields:t.target_fields||[],preferred_countries:t.preferred_countries||[],work_experience_years:t.work_experience_years||0,languages:t.languages||[],circumstances:t.circumstances||{},profile_completeness:I(t),ai_extracted:!0}).eq("user_id",e.id),await u(),setTimeout(()=>{d.push("/qualify?from=onboarding")},2e3)}catch(e){console.error("Error saving profile:",e)}},I=e=>{let t=0;return e.nationality&&(t+=15),e.current_education_level&&(t+=15),e.target_degree&&(t+=15),e.gpa&&(t+=10),e.preferred_countries?.length&&(t+=10),void 0!==e.work_experience_years&&(t+=10),e.circumstances&&Object.keys(e.circumstances).length>0&&(t+=10),e.target_fields?.length&&(t+=10),e.full_name&&(t+=5),Math.min(100,t)};return(0,r.jsxs)("div",{className:"min-h-screen bg-stone-50 flex flex-col",children:[(0,r.jsx)("header",{className:"bg-white border-b border-stone-200 px-4 py-4",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-500 to-accent-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-bold",children:"A"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"font-semibold text-stone-900",children:"Ada"}),(0,r.jsx)("p",{className:"text-xs text-stone-500",children:"Your Scholarship Advisor"})]})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,r.jsx)(a.AnimatePresence,{mode:"popLayout",children:p.map((e,t)=>(0,r.jsx)(o.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,r.jsx)("div",{className:`max-w-[80%] rounded-2xl px-4 py-3 ${"user"===e.role?"bg-primary-500 text-white rounded-br-md":"bg-white shadow-md shadow-stone-200/50 text-stone-900 rounded-bl-md"}`,children:(0,r.jsx)("p",{className:"whitespace-pre-wrap",children:e.content})})},t))}),x&&(0,r.jsx)(o.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:(0,r.jsx)("div",{className:"bg-white shadow-md shadow-stone-200/50 rounded-2xl rounded-bl-md px-4 py-3",children:(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,r.jsx)("span",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,r.jsx)("span",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),(0,r.jsx)("div",{ref:N})]})}),(0,r.jsx)("div",{className:"bg-white border-t border-stone-200 px-4 py-4",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[j&&(0,r.jsx)("button",{onClick:v?()=>{S.current&&(S.current.stop(),L(!1))}:()=>{if(!j)return;let e=window.SpeechRecognition||window.webkitSpeechRecognition;e&&(S.current=new e,S.current.continuous=!1,S.current.interimResults=!1,S.current.lang="en-US",S.current.onresult=e=>{g(e.results[0][0].transcript),L(!1)},S.current.onerror=()=>{L(!1)},S.current.onend=()=>{L(!1)},S.current.start(),L(!0))},className:`p-3 rounded-xl transition-all ${v?"bg-red-500 text-white animate-pulse":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,r.jsx)("div",{className:"flex-1 relative",children:(0,r.jsx)("input",{type:"text",value:f,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),P())},placeholder:v?"Listening...":"Type your message...",disabled:x||v,className:"w-full px-4 py-3 rounded-xl border-2 border-stone-200 focus:border-primary-500 focus:ring-0 transition-colors pr-12"})}),(0,r.jsx)("button",{onClick:P,disabled:!f.trim()||x,className:"p-3 rounded-xl bg-primary-500 text-white hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),(0,r.jsx)("p",{className:"text-xs text-stone-500 text-center mt-2",children:j?"Tap the microphone to speak, or type your response":"Type your response and press Enter"})]})})]})}e.s(["default",()=>u])}]);