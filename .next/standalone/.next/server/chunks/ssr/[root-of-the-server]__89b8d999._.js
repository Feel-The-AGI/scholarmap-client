module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},13289,(a,b,c)=>{"use strict";b.exports=a.r(23739).vendored.contexts.HooksClientContext},81007,(a,b,c)=>{"use strict";b.exports=a.r(23739).vendored.contexts.ServerInsertedHtml},38069,a=>{"use strict";var b=a.i(92742),c=a.i(46390),d=a.i(6620),e=a.i(47650),f=a.i(29689),g=a.i(64458),h=a.i(68169),i=c,j=a.i(54473);function k(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class l extends i.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,h.isHTMLElement)(a)&&a.offsetWidth||0,d=this.props.sizeRef.current;d.height=b.offsetHeight||0,d.width=b.offsetWidth||0,d.top=b.offsetTop,d.left=b.offsetLeft,d.right=c-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:a,isPresent:d,anchorX:e,root:f}){let g=(0,i.useId)(),h=(0,i.useRef)(null),m=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:n}=(0,i.useContext)(j.MotionConfigContext),o=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=k(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():k(a[b],null)}}}}(...a),a)}(h,a.props?.ref??a?.ref);return(0,i.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:i,right:j}=m.current;if(d||!h.current||!a||!b)return;let k="left"===e?`left: ${i}`:`right: ${j}`;h.current.dataset.motionPopId=g;let l=document.createElement("style");n&&(l.nonce=n);let o=f??document.head;return o.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${k}px !important;
            top: ${c}px !important;
          }
        `),()=>{o.contains(l)&&o.removeChild(l)}},[d]),(0,b.jsx)(l,{isPresent:d,childRef:h,sizeRef:m,children:i.cloneElement(a,{ref:o})})}let n=({children:a,initial:d,isPresent:f,onExitComplete:h,custom:i,presenceAffectsLayout:j,mode:k,anchorX:l,root:n})=>{let p=(0,e.useConstant)(o),q=(0,c.useId)(),r=!0,s=(0,c.useMemo)(()=>(r=!1,{id:q,initial:d,isPresent:f,custom:i,onExitComplete:a=>{for(let b of(p.set(a,!0),p.values()))if(!b)return;h&&h()},register:a=>(p.set(a,!1),()=>p.delete(a))}),[f,p,h]);return j&&r&&(s={...s}),(0,c.useMemo)(()=>{p.forEach((a,b)=>p.set(b,!1))},[f]),c.useEffect(()=>{f||p.size||!h||h()},[f]),"popLayout"===k&&(a=(0,b.jsx)(m,{isPresent:f,anchorX:l,root:n,children:a})),(0,b.jsx)(g.PresenceContext.Provider,{value:s,children:a})};function o(){return new Map}var p=a.i(91936);let q=a=>a.key||"";function r(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let s=({children:a,custom:g,initial:h=!0,onExitComplete:i,presenceAffectsLayout:j=!0,mode:k="sync",propagate:l=!1,anchorX:m="left",root:o})=>{let[s,t]=(0,p.usePresence)(l),u=(0,c.useMemo)(()=>r(a),[a]),v=l&&!s?[]:u.map(q),w=(0,c.useRef)(!0),x=(0,c.useRef)(u),y=(0,e.useConstant)(()=>new Map),z=(0,c.useRef)(new Set),[A,B]=(0,c.useState)(u),[C,D]=(0,c.useState)(u);(0,f.useIsomorphicLayoutEffect)(()=>{w.current=!1,x.current=u;for(let a=0;a<C.length;a++){let b=q(C[a]);v.includes(b)?(y.delete(b),z.current.delete(b)):!0!==y.get(b)&&y.set(b,!1)}},[C,v.length,v.join("-")]);let E=[];if(u!==A){let a=[...u];for(let b=0;b<C.length;b++){let c=C[b],d=q(c);v.includes(d)||(a.splice(b,0,c),E.push(c))}return"wait"===k&&E.length&&(a=E),D(r(a)),B(u),null}let{forceRender:F}=(0,c.useContext)(d.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:C.map(a=>{let c=q(a),d=(!l||!!s)&&(u===C||v.includes(c));return(0,b.jsx)(n,{isPresent:d,initial:(!w.current||!!h)&&void 0,custom:g,presenceAffectsLayout:j,mode:k,root:o,onExitComplete:d?void 0:()=>{if(z.current.has(c)||(z.current.add(c),!y.has(c)))return;y.set(c,!0);let a=!0;y.forEach(b=>{b||(a=!1)}),a&&(F?.(),D(x.current),l&&t?.(),i&&i())},anchorX:m,children:a},c)})})};a.s(["AnimatePresence",()=>s],38069)},63778,a=>{"use strict";var b=a.i(92742),c=a.i(46390),d=a.i(3e3),e=a.i(78653),f=a.i(38069),g=a.i(60721),h=a.i(10849);let i=`Hey there! I'm Ada, your scholarship advisor. Let's chat for a couple of minutes so I can find the perfect scholarships for you.

What's your name and where are you from?`;function j(){let{user:a,refreshUser:j}=(0,g.useAuth)(),k=(0,d.useRouter)(),l=(0,h.createClient)(),[m,n]=(0,c.useState)([{role:"assistant",content:i,timestamp:new Date().toISOString()}]),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)({}),[u,v]=(0,c.useState)(0),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),A=(0,c.useRef)(null),B=(0,c.useRef)(null);(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{A.current?.scrollIntoView({behavior:"smooth"})},[m]);let C=async()=>{if(!o.trim()||q)return;let a={role:"user",content:o.trim(),timestamp:new Date().toISOString()};n(b=>[...b,a]),p(""),r(!0);try{let b=await fetch(`${process.env.NEXT_PUBLIC_AGENT_URL}/onboarding/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...m,a],current_step:u,extracted_data:s})});if(!b.ok)throw Error("Failed to get response");let c=await b.json();c.extracted_data&&t(a=>({...a,...c.extracted_data}));let d={role:"assistant",content:c.response,timestamp:new Date().toISOString()};n(a=>[...a,d]),v(c.next_step),c.is_complete&&await E(c.extracted_data)}catch(b){console.error("Chat error:",b),D(a.content)}finally{r(!1)}},D=a=>{let b="",c={...s};switch(u){case 0:let d=a.split(/from|,/i);d.length>=1&&(c.full_name=d[0].replace(/i'm|i am|my name is/i,"").trim()),d.length>=2&&(c.nationality=d[1].trim()),b=`Nice to meet you${c.full_name?`, ${c.full_name}`:""}! What are you currently studying or what did you last complete? (e.g., "Finished BSc in Computer Science at MIT")`,v(1);break;case 1:a.toLowerCase().includes("bachelor")||a.toLowerCase().includes("bsc")||a.toLowerCase().includes("ba")?c.current_education_level="undergraduate":a.toLowerCase().includes("master")||a.toLowerCase().includes("msc")||a.toLowerCase().includes("ma")?c.current_education_level="graduate":a.toLowerCase().includes("phd")||a.toLowerCase().includes("doctor")?c.current_education_level="professional":(a.toLowerCase().includes("high school")||a.toLowerCase().includes("secondary"))&&(c.current_education_level="high_school"),b="Got it! So you're looking for a Master's, PhD, or another degree next? And which countries are you interested in studying in?",v(2);break;case 2:a.toLowerCase().includes("master")?c.target_degree="masters":a.toLowerCase().includes("phd")||a.toLowerCase().includes("doctor")?c.target_degree="phd":a.toLowerCase().includes("bachelor")?c.target_degree="bachelor":a.toLowerCase().includes("postdoc")&&(c.target_degree="postdoc");let e=[];(a.toLowerCase().includes("us")||a.toLowerCase().includes("america")||a.toLowerCase().includes("usa"))&&e.push("United States"),(a.toLowerCase().includes("uk")||a.toLowerCase().includes("britain")||a.toLowerCase().includes("england"))&&e.push("United Kingdom"),a.toLowerCase().includes("canada")&&e.push("Canada"),a.toLowerCase().includes("germany")&&e.push("Germany"),a.toLowerCase().includes("australia")&&e.push("Australia"),c.preferred_countries=e,b="Great choices! Quick question - what was your GPA (roughly)? And do you have any work experience?",v(3);break;case 3:let f=a.match(/(\d+\.?\d*)/);f&&(c.gpa=parseFloat(f[1]));let g=a.match(/(\d+)\s*(year|month)/i);g&&(c.work_experience_years="month"===g[2].toLowerCase()?Math.round(parseInt(g[1])/12):parseInt(g[1])),b="Last thing - any special circumstances that might help your application? (First-generation student, financial need, disability, refugee status?)",v(4);break;case 4:c.circumstances={financial_need:a.toLowerCase().includes("financial")||a.toLowerCase().includes("aid")||a.toLowerCase().includes("need"),first_gen:a.toLowerCase().includes("first")||a.toLowerCase().includes("first-gen")||a.toLowerCase().includes("first generation"),refugee:a.toLowerCase().includes("refugee")||a.toLowerCase().includes("displaced"),disability:a.toLowerCase().includes("disability")||a.toLowerCase().includes("disabled")},b="Perfect! I've got everything I need. Let me find the best scholarships for you...",v(5),setTimeout(()=>E(c),1500);break;default:b="Thanks! Processing your information..."}t(c),n(a=>[...a,{role:"assistant",content:b,timestamp:new Date().toISOString()}])},E=async b=>{if(a)try{b.full_name?await l.from("users").update({full_name:b.full_name,onboarding_complete:!0}).eq("id",a.id):await l.from("users").update({onboarding_complete:!0}).eq("id",a.id),await l.from("academic_profiles").update({nationality:b.nationality,country_of_residence:b.country_of_residence,current_education_level:b.current_education_level,current_institution:b.current_institution,graduation_year:b.graduation_year,gpa:b.gpa,target_degree:b.target_degree,target_fields:b.target_fields||[],preferred_countries:b.preferred_countries||[],work_experience_years:b.work_experience_years||0,languages:b.languages||[],circumstances:b.circumstances||{},profile_completeness:F(b),ai_extracted:!0}).eq("user_id",a.id),await j(),setTimeout(()=>{k.push("/qualify?from=onboarding")},2e3)}catch(a){console.error("Error saving profile:",a)}},F=a=>{let b=0;return a.nationality&&(b+=15),a.current_education_level&&(b+=15),a.target_degree&&(b+=15),a.gpa&&(b+=10),a.preferred_countries?.length&&(b+=10),void 0!==a.work_experience_years&&(b+=10),a.circumstances&&Object.keys(a.circumstances).length>0&&(b+=10),a.target_fields?.length&&(b+=10),a.full_name&&(b+=5),Math.min(100,b)};return(0,b.jsxs)("div",{className:"min-h-screen bg-stone-50 flex flex-col",children:[(0,b.jsx)("header",{className:"bg-white border-b border-stone-200 px-4 py-4",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-500 to-accent-500 rounded-full flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-white font-bold",children:"A"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-semibold text-stone-900",children:"Ada"}),(0,b.jsx)("p",{className:"text-xs text-stone-500",children:"Your Scholarship Advisor"})]})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,b.jsx)(f.AnimatePresence,{mode:"popLayout",children:m.map((a,c)=>(0,b.jsx)(e.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`flex ${"user"===a.role?"justify-end":"justify-start"}`,children:(0,b.jsx)("div",{className:`max-w-[80%] rounded-2xl px-4 py-3 ${"user"===a.role?"bg-primary-500 text-white rounded-br-md":"bg-white shadow-md shadow-stone-200/50 text-stone-900 rounded-bl-md"}`,children:(0,b.jsx)("p",{className:"whitespace-pre-wrap",children:a.content})})},c))}),q&&(0,b.jsx)(e.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:(0,b.jsx)("div",{className:"bg-white shadow-md shadow-stone-200/50 rounded-2xl rounded-bl-md px-4 py-3",children:(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("span",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,b.jsx)("span",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,b.jsx)("span",{className:"w-2 h-2 bg-stone-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),(0,b.jsx)("div",{ref:A})]})}),(0,b.jsx)("div",{className:"bg-white border-t border-stone-200 px-4 py-4",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[y&&(0,b.jsx)("button",{onClick:w?()=>{B.current&&(B.current.stop(),x(!1))}:()=>{if(!y)return;let a=window.SpeechRecognition||window.webkitSpeechRecognition;a&&(B.current=new a,B.current.continuous=!1,B.current.interimResults=!1,B.current.lang="en-US",B.current.onresult=a=>{p(a.results[0][0].transcript),x(!1)},B.current.onerror=()=>{x(!1)},B.current.onend=()=>{x(!1)},B.current.start(),x(!0))},className:`p-3 rounded-xl transition-all ${w?"bg-red-500 text-white animate-pulse":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,b.jsx)("div",{className:"flex-1 relative",children:(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),onKeyPress:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),C())},placeholder:w?"Listening...":"Type your message...",disabled:q||w,className:"w-full px-4 py-3 rounded-xl border-2 border-stone-200 focus:border-primary-500 focus:ring-0 transition-colors pr-12"})}),(0,b.jsx)("button",{onClick:C,disabled:!o.trim()||q,className:"p-3 rounded-xl bg-primary-500 text-white hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),(0,b.jsx)("p",{className:"text-xs text-stone-500 text-center mt-2",children:y?"Tap the microphone to speak, or type your response":"Type your response and press Enter"})]})})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__89b8d999._.js.map